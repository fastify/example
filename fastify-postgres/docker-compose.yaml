version: "3.8"
  services:
    fastify_postgres:
      build:
        context: ./
        dockerfile: Dockerfile
      volumes:
        - .:/src
      command: >
        sh -c "npm start"
      expose:
        - "3000"
      ports:
        - "3000:3000"
      depends_on:
        - db_postgres

    db_postgres:
      image: postgres:latest
      expose:
        - "5432"
      ports:
        - "5432:5432"
      environment:
        - POSTGRES_DB=fastify_postgres
        - POSTGRES_USER=postgres
        - POSTGRES_PASSWORD=postgres

   integration_test:
    command: >
      sh -c "npm test"
